#pragma once
#include "sutil/vec_math.h"

#define REFLECTION_LUT_SIZE 16
__constant__ float REFLECTION_LUT[] = {
    0.99996,  0.857567,    1,        0.613357,    1,        0.430158,
    1,        0.291317,    1,        0.191123,    1,        0.121853,
    1,        0.0737236,   1,        0.0426714,   1,        0.0226787,
    1,        0.0110401,   1,        0.004831,    1,        0.00174798,
    1,        0.000497539, 1,        9.30014e-05, 1,        7.2597e-06,
    1,        3.09218e-08, 0.969316, 0.796889,    0.998616, 0.602773,
    0.999749, 0.42375,     0.999911, 0.289402,    0.999957, 0.191513,
    0.999975, 0.121423,    0.999986, 0.0737555,   0.999992, 0.0425217,
    0.999992, 0.022743,    0.999993, 0.0111702,   0.999994, 0.00487504,
    0.999996, 0.00180042,  0.999997, 0.000522797, 0.999997, 0.000104113,
    0.999998, 1.30154e-05, 0.999999, 3.95074e-06, 0.911128, 0.653753,
    0.973652, 0.552912,    0.992598, 0.406747,    0.997504, 0.28302,
    0.998927, 0.189124,    0.999422, 0.121256,    0.999659, 0.0743001,
    0.999768, 0.0431253,   0.99984,  0.0233819,   0.999879, 0.0116659,
    0.999907, 0.00521385,  0.999928, 0.0020165,   0.999939, 0.000647109,
    0.999949, 0.000173148, 0.999956, 5.44283e-05, 0.999961, 3.47171e-05,
    0.915364, 0.527987,    0.929999, 0.461503,    0.963514, 0.362633,
    0.981993, 0.263486,    0.990413, 0.181194,    0.994683, 0.119005,
    0.996917, 0.074516,    0.998014, 0.0442067,   0.998681, 0.0246599,
    0.999031, 0.0127585,   0.999273, 0.00602457,  0.999422, 0.00256089,
    0.999533, 0.000984755, 0.99961,  0.000377,    0.999668, 0.000183697,
    0.999713, 0.00013492,  0.933829, 0.419512,    0.906348, 0.365376,
    0.928652, 0.300198,    0.951363, 0.229367,    0.968004, 0.164935,
    0.97909,  0.112592,    0.985901, 0.0730908,   0.990336, 0.0451003,
    0.993218, 0.026294,    0.99518,  0.0144021,   0.996406, 0.00737202,
    0.997256, 0.0035367,   0.997801, 0.0016408,   0.9982,   0.000804832,
    0.998484, 0.000476766, 0.998698, 0.000366683, 0.947613, 0.328263,
    0.903226, 0.283533,    0.904769, 0.237494,    0.920904, 0.188578,
    0.937961, 0.141864,    0.952392, 0.10139,     0.964112, 0.0690311,
    0.972977, 0.0448023,   0.979433, 0.0276846,   0.984175, 0.0162792,
    0.987751, 0.0091286,   0.990416, 0.004946,    0.992394, 0.0026764,
    0.993836, 0.00153867,  0.994876, 0.00101451,  0.995646, 0.000807948,
    0.955254, 0.255178,    0.906633, 0.217863,    0.893233, 0.183691,
    0.897679, 0.14959,     0.909399, 0.116812,    0.922697, 0.0872683,
    0.935233, 0.0625016,   0.946505, 0.0429091,   0.956154, 0.0283014,
    0.964116, 0.0179616,   0.970536, 0.0110547,   0.975729, 0.00669429,
    0.979948, 0.00409717,  0.983379, 0.00263375,  0.986112, 0.00187608,
    0.988238, 0.00154693,  0.958291, 0.198168,    0.909078, 0.167156,
    0.887028, 0.140898,    0.881583, 0.116611,    0.885471, 0.093703,
    0.894124, 0.0728227,   0.904621, 0.0547433,   0.915406, 0.0397687,
    0.925816, 0.028028,    0.935533, 0.0192078,   0.944199, 0.0129241,
    0.951795, 0.00862723,  0.958379, 0.00584545,  0.964087, 0.00412568,
    0.969039, 0.0031268,   0.973308, 0.00267491,  0.957972, 0.154681,
    0.907753, 0.12887,     0.880659, 0.108127,    0.868161, 0.0902681,
    0.865104, 0.0741985,   0.867948, 0.0597649,   0.874334, 0.0469636,
    0.882626, 0.0360304,   0.891712, 0.0270867,   0.901022, 0.0199812,
    0.910283, 0.0145994,   0.919069, 0.0106402,   0.927245, 0.00786341,
    0.934773, 0.0059862,   0.941682, 0.0048095,   0.94806,  0.00427844,
    0.955139, 0.122022,    0.902255, 0.100146,    0.871352, 0.0834929,
    0.853759, 0.0700302,   0.845198, 0.0586638,   0.842802, 0.0486679,
    0.844598, 0.0398751,   0.849199, 0.0322652,   0.85565,  0.025755,
    0.863103, 0.0203556,   0.871132, 0.0160302,   0.879469, 0.0126208,
    0.887854, 0.0100484,   0.896031, 0.00818344,  0.903933, 0.00693877,
    0.911553, 0.00643034,  0.950338, 0.0973665,   0.892921, 0.0787407,
    0.858175, 0.0652761,   0.836408, 0.0548976,   0.823351, 0.0465984,
    0.816601, 0.0396924,   0.814228, 0.033836,    0.81507,  0.0286997,
    0.818164, 0.0242504,   0.823016, 0.0204116,   0.828887, 0.0171836,
    0.835466, 0.0144972,   0.842599, 0.0123192,   0.850108, 0.0106398,
    0.857721, 0.00949874,  0.865341, 0.0091831,   0.943943, 0.0788242,
    0.880349, 0.062878,    0.841247, 0.0517303,   0.815521, 0.0435974,
    0.798638, 0.0374635,   0.787982, 0.0327137,   0.782012, 0.0288222,
    0.779441, 0.0255455,   0.779457, 0.0227188,   0.781301, 0.0202449,
    0.784776, 0.018074,    0.789197, 0.0161862,   0.79434,  0.0145666,
    0.800185, 0.0132724,   0.806521, 0.0124416,   0.813115, 0.0125655,
    0.936246, 0.064938,    0.865183, 0.0509343,   0.821176, 0.0416701,
    0.791352, 0.0352258,   0.77075,  0.030676,    0.756854, 0.0273407,
    0.747664, 0.0248406,   0.74214,  0.0228878,   0.739413, 0.0212888,
    0.73885,  0.0199184,   0.739809, 0.0187062,   0.74227,  0.0176315,
    0.745538, 0.0166946,   0.749507, 0.0159755,   0.754274, 0.0156944,
    0.759472, 0.0165746,   0.92747,  0.0543281,   0.847906, 0.0419504,
    0.798477, 0.0341916,   0.764506, 0.0290625,   0.740582, 0.0256084,
    0.723486, 0.0232978,   0.711615, 0.0217569,   0.703667, 0.0207236,
    0.6987,   0.020014,    0.696145, 0.019502,    0.695446, 0.0191116,
    0.696144, 0.0188142,   0.698171, 0.0186206,   0.700892, 0.0186381,
    0.704417, 0.0191575,   0.708631, 0.0211748,   0.917795, 0.0462024,
    0.829026, 0.0351286,   0.773883, 0.0285879,   0.735938, 0.02445,
    0.708606, 0.021851,    0.688864, 0.0202803,   0.674742, 0.0194084,
    0.6648,   0.019011,    0.658301, 0.0189321,   0.654324, 0.0190642,
    0.652584, 0.0193434,   0.652452, 0.0197537,   0.653762, 0.0203207,
    0.656252, 0.021182,    0.659453, 0.0227315,   0.663621, 0.0263075,
    0.907392, 0.039918,    0.808982, 0.0299145,   0.74825,  0.0243308,
    0.70629,  0.0210062,   0.675967, 0.0190676,   0.654034, 0.0180436,
    0.637989, 0.017652,    0.626833, 0.0176967,   0.619173, 0.0180534,
    0.614686, 0.018656,    0.612423, 0.0194625,   0.612365, 0.0204817,
    0.613799, 0.0217743,   0.616803, 0.0235416,   0.620872, 0.0263185,
    0.626059, 0.0318956};

#define REFLECTION_IOR1_LUT_SIZE 16
__constant__ float REFLECTION_IOR1_LUT[] = {
    0.99996,     1,           1,           1,           1,
    1,           1,           1,           1,           1,
    1,           1,           1,           1,           1,
    1,           0.969316,    0.998616,    0.999749,    0.999911,
    0.999957,    0.999975,    0.999986,    0.999992,    0.999992,
    0.999993,    0.999994,    0.999996,    0.999997,    0.999997,
    0.999998,    0.999996,    0.911126,    0.973652,    0.992597,
    0.997504,    0.998927,    0.999422,    0.999659,    0.999768,
    0.99984,     0.999879,    0.999907,    0.999927,    0.999938,
    0.999947,    0.999953,    0.99994,     0.915359,    0.929995,
    0.963512,    0.981992,    0.990411,    0.994681,    0.996916,
    0.998013,    0.99868,     0.999029,    0.999271,    0.99942,
    0.99953,     0.999606,    0.999658,    0.999627,    0.933819,
    0.906342,    0.928647,    0.951359,    0.968,       0.979087,
    0.985898,    0.990333,    0.993216,    0.995176,    0.996402,
    0.99725,     0.997793,    0.998188,    0.998457,    0.998496,
    0.947599,    0.903213,    0.90476,     0.920896,    0.937955,
    0.952385,    0.964105,    0.972971,    0.979427,    0.984167,
    0.987743,    0.990405,    0.992379,    0.993811,    0.994815,
    0.995279,    0.955233,    0.906613,    0.893216,    0.897664,
    0.909385,    0.922686,    0.935221,    0.946491,    0.956141,
    0.964101,    0.97052,     0.975707,    0.979918,    0.98333,
    0.986008,    0.987713,    0.958262,    0.909049,    0.887003,
    0.881558,    0.885449,    0.894102,    0.904601,    0.915389,
    0.925793,    0.935508,    0.944168,    0.951757,    0.958329,
    0.96401,     0.968881,    0.972692,    0.957935,    0.907717,
    0.880623,    0.868126,    0.86507,     0.867918,    0.8743,
    0.882593,    0.89168,     0.900988,    0.910235,    0.919012,
    0.92717,     0.934663,    0.941477,    0.947442,    0.955093,
    0.902208,    0.871306,    0.85371,     0.845153,    0.842755,
    0.844555,    0.84915,     0.855598,    0.863048,    0.871081,
    0.87939,     0.88775,     0.895883,    0.903688,    0.910988,
    0.950283,    0.892865,    0.858115,    0.836352,    0.82329,
    0.816543,    0.814167,    0.815012,    0.818097,    0.822939,
    0.828803,    0.835388,    0.84247,     0.84993,     0.857457,
    0.864862,    0.943876,    0.88028,     0.841177,    0.815446,
    0.798568,    0.787904,    0.781936,    0.779357,    0.779377,
    0.78121,     0.784667,    0.789075,    0.794224,    0.799984,
    0.806261,    0.812722,    0.936167,    0.865103,    0.821093,
    0.791268,    0.770661,    0.756764,    0.747567,    0.742048,
    0.739305,    0.738747,    0.739691,    0.742125,    0.745377,
    0.749345,    0.754024,    0.759155,    0.927376,    0.847808,
    0.798377,    0.764408,    0.740478,    0.723383,    0.711508,
    0.703551,    0.69859,     0.696014,    0.695315,    0.696004,
    0.698007,    0.700719,    0.704204,    0.708375,    0.917685,
    0.828915,    0.773768,    0.735822,    0.708494,    0.688741,
    0.674619,    0.664674,    0.658173,    0.654192,    0.652444,
    0.652302,    0.653612,    0.656092,    0.659267,    0.663417,
    0.90727,     0.808858,    0.748121,    0.706156,    0.675835,
    0.653904,    0.637856,    0.626697,    0.619035,    0.61455,
    0.612284,    0.612227,    0.613656,    0.616651,    0.620718,
    0.625903,    0.99996,     1,           1,           1,
    1,           1,           1,           1,           1,
    1,           1,           1,           1,           1,
    1,           0.999999,    0.969312,    0.998614,    0.999748,
    0.99991,     0.999957,    0.999975,    0.999985,    0.999991,
    0.999991,    0.999993,    0.999993,    0.999996,    0.999995,
    0.999993,    0.99999,     0.999912,    0.911097,    0.973636,
    0.992585,    0.997496,    0.99892,     0.999416,    0.999653,
    0.999761,    0.999833,    0.999873,    0.999899,    0.999916,
    0.999923,    0.999922,    0.999891,    0.999316,    0.915273,
    0.929936,    0.963472,    0.98196,     0.990384,    0.994657,
    0.996893,    0.997991,    0.998655,    0.999003,    0.999239,
    0.999381,    0.999474,    0.999508,    0.999412,    0.997407,
    0.933649,    0.906208,    0.92855,     0.951274,    0.967928,
    0.979019,    0.985835,    0.990271,    0.993151,    0.995104,
    0.996316,    0.997143,    0.997642,    0.997931,    0.997821,
    0.993328,    0.947326,    0.902972,    0.904567,    0.92072,
    0.937801,    0.952244,    0.963967,    0.97283,     0.979279,
    0.984008,    0.987557,    0.990171,    0.992047,    0.993254,
    0.993506,    0.986487,    0.954838,    0.906233,    0.892898,
    0.89736,     0.909101,    0.922421,    0.934962,    0.94623,
    0.95586,     0.963793,    0.970163,    0.97526,     0.979302,
    0.982317,    0.983751,    0.97598,     0.957723,    0.908509,
    0.886524,    0.881089,    0.884997,    0.893665,    0.90417,
    0.914944,    0.925328,    0.934987,    0.943558,    0.951002,
    0.9573,      0.962389,    0.965542,    0.959633,    0.957233,
    0.906985,    0.879955,    0.867455,    0.864404,    0.867255,
    0.873638,    0.881907,    0.890953,    0.900189,    0.909311,
    0.917848,    0.925622,    0.932341,    0.937136,    0.934663,
    0.954211,    0.901277,    0.870432,    0.852804,    0.844243,
    0.841837,    0.843612,    0.848173,    0.854551,    0.8619,
    0.869766,    0.877795,    0.885647,    0.892871,    0.898644,
    0.89954,     0.949199,    0.891713,    0.857023,    0.835192,
    0.822092,    0.815334,    0.812919,    0.813699,    0.816693,
    0.821396,    0.827053,    0.833325,    0.8399,      0.846376,
    0.852098,    0.855146,    0.942569,    0.878892,    0.839847,
    0.814034,    0.797088,    0.786366,    0.780353,    0.777709,
    0.777599,    0.779268,    0.782498,    0.786571,    0.791231,
    0.796199,    0.800944,    0.804755,    0.934622,    0.863458,
    0.8195,      0.789573,    0.7689,      0.754926,    0.745642,
    0.740039,    0.737195,    0.736454,    0.737161,    0.739296,
    0.742114,    0.745491,    0.749168,    0.752712,    0.925573,
    0.845877,    0.7965,      0.762398,    0.7384,      0.721247,
    0.709289,    0.701215,    0.696151,    0.693445,    0.69255,
    0.692989,    0.694685,    0.696979,    0.699912,    0.703251,
    0.915613,    0.826675,    0.771623,    0.733536,    0.706093,
    0.686301,    0.672118,    0.662095,    0.655507,    0.651418,
    0.649554,    0.64926,     0.650379,    0.652658,    0.65554,
    0.659365,    0.904906,    0.806314,    0.745709,    0.7036,
    0.673184,    0.651209,    0.635119,    0.623924,    0.616223,
    0.611702,    0.609383,    0.609281,    0.61065,     0.6136,
    0.617586,    0.622675,    0.99996,     1,           1,
    1,           1,           1,           1,           1,
    1,           1,           1,           1,           1,
    1,           1,           0.999993,    0.969298,    0.998607,
    0.999743,    0.999906,    0.999952,    0.999972,    0.999983,
    0.999989,    0.999989,    0.999989,    0.999989,    0.99999,
    0.999989,    0.999981,    0.999956,    0.999319,    0.911009,
    0.97359,     0.992551,    0.997469,    0.998896,    0.999394,
    0.999633,    0.999742,    0.999812,    0.99985,     0.99987,
    0.999883,    0.999874,    0.999831,    0.999637,    0.994988,
    0.915014,    0.92978,     0.963345,    0.981863,    0.990299,
    0.994576,    0.996818,    0.997914,    0.998578,    0.998915,
    0.999139,    0.999249,    0.999283,    0.999162,    0.998472,
    0.983314,    0.933136,    0.905837,    0.928235,    0.951028,
    0.967706,    0.978808,    0.985628,    0.990062,    0.992928,
    0.994865,    0.996034,    0.996783,    0.997118,    0.99701,
    0.995375,    0.965294,    0.946486,    0.902293,    0.903959,
    0.920226,    0.937341,    0.951792,    0.963521,    0.972379,
    0.978797,    0.98347,     0.986922,    0.989358,    0.990901,
    0.991289,    0.988546,    0.946752,    0.953615,    0.905162,
    0.891885,    0.896512,    0.908297,    0.921605,    0.934141,
    0.945384,    0.954958,    0.962784,    0.968963,    0.97374,
    0.977143,    0.97871,     0.975429,    0.930738,    0.956069,
    0.906966,    0.885009,    0.879781,    0.883725,    0.892359,
    0.902831,    0.913545,    0.923811,    0.93329,     0.941556,
    0.948457,    0.953762,    0.956675,    0.953531,    0.914522,
    0.955087,    0.904889,    0.877822,    0.865561,    0.862546,
    0.865336,    0.871647,    0.879802,    0.888662,    0.897599,
    0.906256,    0.914045,    0.920424,    0.924332,    0.921986,
    0.893133,    0.951507,    0.898549,    0.86761,     0.850237,
    0.841658,    0.839139,    0.840818,    0.84522,     0.851349,
    0.858285,    0.865504,    0.87256,     0.878756,    0.882789,
    0.881596,    0.86316,     0.945864,    0.888303,    0.853437,
    0.831872,    0.818722,    0.811752,    0.809165,    0.809744,
    0.812455,    0.816681,    0.821589,    0.826694,    0.831459,
    0.83487,     0.834497,    0.824424,    0.938548,    0.874773,
    0.835498,    0.809958,    0.792845,    0.781867,    0.775587,
    0.772665,    0.772215,    0.773425,    0.775896,    0.778816,
    0.781696,    0.783957,    0.78416,     0.779498,    0.929861,
    0.858595,    0.814324,    0.784707,    0.763842,    0.749485,
    0.739881,    0.733946,    0.730711,    0.7295,      0.729577,
    0.730708,    0.732085,    0.733288,    0.733992,    0.732618,
    0.920019,    0.840226,    0.79049,     0.756754,    0.732528,
    0.714937,    0.702616,    0.694207,    0.688743,    0.685588,
    0.684144,    0.683878,    0.684581,    0.685566,    0.686706,
    0.687522,    0.909204,    0.820195,    0.764724,    0.727083,
    0.699458,    0.67921,     0.664667,    0.654366,    0.647471,
    0.643025,    0.640773,    0.640031,    0.640623,    0.642176,
    0.64427,     0.646988,    0.897602,    0.798961,    0.737904,
    0.69635,     0.665785,    0.643395,    0.627061,    0.615641,
    0.607811,    0.603119,    0.600628,    0.600368,    0.601602,
    0.604298,    0.608075,    0.612892,    0.99996,     1,
    1,           1,           1,           1,           1,
    0.999999,    0.999999,    0.999999,    0.999999,    0.999999,
    0.999999,    0.999999,    0.999999,    0.999864,    0.969274,
    0.998597,    0.999735,    0.999899,    0.999948,    0.999967,
    0.999977,    0.999984,    0.999984,    0.999984,    0.999983,
    0.999981,    0.999975,    0.999956,    0.999869,    0.989632,
    0.910854,    0.973517,    0.992495,    0.997418,    0.998858,
    0.999358,    0.999599,    0.999706,    0.999776,    0.999806,
    0.99982,     0.999815,    0.99977,     0.99963,     0.998963,
    0.942474,    0.914536,    0.929516,    0.963138,    0.981678,
    0.990148,    0.994443,    0.996684,    0.997778,    0.99843,
    0.998749,    0.99894,     0.998987,    0.998883,    0.998406,
    0.995971,    0.882649,    0.932146,    0.905187,    0.927701,
    0.950546,    0.967305,    0.978446,    0.985268,    0.989691,
    0.992533,    0.994418,    0.995502,    0.996078,    0.996059,
    0.994997,    0.989087,    0.846925,    0.94485,     0.901058,
    0.90288,     0.919223,    0.936477,    0.950999,    0.96273,
    0.971555,    0.977921,    0.982492,    0.985753,    0.987839,
    0.988628,    0.987087,    0.976466,    0.8335,      0.951205,
    0.903179,    0.890051,    0.894751,    0.906752,    0.920148,
    0.932646,    0.9438,      0.953262,    0.960892,    0.966722,
    0.970853,    0.972966,    0.971359,    0.95659,     0.830661,
    0.952763,    0.904102,    0.882251,    0.877035,    0.881259,
    0.889989,    0.90036,     0.910887,    0.920907,    0.930014,
    0.937709,    0.943604,    0.946943,    0.945393,    0.928658,
    0.828606,    0.950788,    0.901067,    0.874021,    0.861678,
    0.85897,     0.86182,     0.867932,    0.875767,    0.884221,
    0.892559,    0.900284,    0.906619,    0.910415,    0.908911,
    0.892853,    0.820317,    0.94612,     0.893647,    0.862593,
    0.845044,    0.836828,    0.834326,    0.835656,    0.839556,
    0.845079,    0.851187,    0.857178,    0.862284,    0.865348,
    0.863708,    0.850254,    0.802235,    0.939318,    0.882192,
    0.847098,    0.825215,    0.812459,    0.805491,    0.802458,
    0.802341,    0.804216,    0.807394,    0.810844,    0.813771,
    0.815105,    0.813107,    0.803078,    0.773891,    0.930751,
    0.867349,    0.827711,    0.801708,    0.785078,    0.774051,
    0.767218,    0.763512,    0.762101,    0.762073,    0.762978,
    0.763707,    0.763413,    0.760986,    0.754373,    0.737973,
    0.920721,    0.849764,    0.805057,    0.774843,    0.75449,
    0.74011,     0.729888,    0.723053,    0.718873,    0.716432,
    0.714963,    0.714244,    0.713115,    0.710892,    0.706927,
    0.698785,    0.909451,    0.829953,    0.779702,    0.74526,
    0.721665,    0.704065,    0.691076,    0.681787,    0.675405,
    0.671215,    0.66859,     0.666955,    0.665898,    0.664586,
    0.662798,    0.66007,     0.897115,    0.808444,    0.752394,
    0.713964,    0.687166,    0.666972,    0.651836,    0.640703,
    0.633062,    0.627878,    0.624773,    0.623182,    0.622764,
    0.623089,    0.623757,    0.624916,    0.88391,     0.785703,
    0.724008,    0.681632,    0.652111,    0.629972,    0.613206,
    0.601179,    0.59286,     0.587739,    0.584904,    0.584199,
    0.5851,      0.587445,    0.590804,    0.595169,    0.999958,
    0.999999,    0.999999,    0.999999,    0.999999,    0.999999,
    0.999999,    0.999999,    0.999999,    0.999999,    0.999999,
    0.999999,    0.999999,    0.999999,    0.999994,    0.324051,
    0.969241,    0.998584,    0.999724,    0.99989,     0.999938,
    0.999959,    0.999969,    0.999975,    0.999976,    0.999974,
    0.999969,    0.999964,    0.99995,     0.999899,    0.999603,
    0.337441,    0.910615,    0.973408,    0.992416,    0.997348,
    0.998789,    0.999297,    0.99954,     0.999648,    0.999711,
    0.999733,    0.99973,     0.999688,    0.99957,     0.9992,
    0.996967,    0.399736,    0.913828,    0.929135,    0.962851,
    0.981422,    0.989902,    0.994218,    0.996471,    0.997556,
    0.998188,    0.998469,    0.998593,    0.998513,    0.998124,
    0.996779,    0.988814,    0.491667,    0.93072,     0.904273,
    0.926977,    0.949891,    0.96667,     0.977864,    0.98471,
    0.98911,     0.991894,    0.99367,     0.99457,     0.994808,
    0.994041,    0.990777,    0.972257,    0.569537,    0.942465,
    0.899302,    0.901411,    0.917862,    0.935159,    0.949788,
    0.96156,     0.970336,    0.976547,    0.980876,    0.983745,
    0.985105,    0.98434,     0.978477,    0.947142,    0.627103,
    0.947652,    0.900293,    0.887505,    0.892313,    0.904349,
    0.917941,    0.93051,     0.94157,     0.950737,    0.957912,
    0.963028,    0.965858,    0.965298,    0.956815,    0.915783,
    0.669352,    0.947857,    0.899842,    0.878311,    0.873154,
    0.87736,     0.886357,    0.896814,    0.907172,    0.916738,
    0.925129,    0.931674,    0.935573,    0.935004,    0.924371,
    0.880225,    0.698142,    0.944336,    0.89523,     0.868426,
    0.856016,    0.853177,    0.85635,     0.86253,     0.870082,
    0.877842,    0.885151,    0.891341,    0.895037,    0.893897,
    0.882169,    0.841332,    0.712802,    0.93796,     0.886082,
    0.855167,    0.837382,    0.828824,    0.826666,    0.828014,
    0.831483,    0.836049,    0.840783,    0.844845,    0.846901,
    0.844696,    0.83298,     0.799403,    0.712907,    0.929292,
    0.872792,    0.837686,    0.815365,    0.802069,    0.795435,
    0.792343,    0.791636,    0.7923,      0.793813,    0.795048,
    0.794746,    0.7911,      0.780518,    0.755283,    0.700477,
    0.918722,    0.855965,    0.816139,    0.789465,    0.772141,
    0.761526,    0.754607,    0.750143,    0.747329,    0.745457,
    0.744078,    0.741807,    0.737151,    0.728277,    0.710919,
    0.678206,    0.906566,    0.836238,    0.791223,    0.760132,
    0.738894,    0.725075,    0.714867,    0.707246,    0.701517,
    0.697259,    0.693684,    0.690237,    0.685604,    0.678694,
    0.667901,    0.650315,    0.893081,    0.814208,    0.763599,
    0.728159,    0.703512,    0.686652,    0.673806,    0.663875,
    0.656097,    0.65027,     0.645797,    0.641997,    0.638409,
    0.634074,    0.62849,     0.62075,     0.878486,    0.790454,
    0.734106,    0.694593,    0.666696,    0.647588,    0.632854,
    0.621324,    0.612464,    0.60599,     0.601612,    0.598594,
    0.596647,    0.595386,    0.594214,    0.592953,    0.862984,
    0.765498,    0.703643,    0.660265,    0.629787,    0.609111,
    0.593118,    0.580975,    0.571824,    0.565759,    0.562229,
    0.560908,    0.561183,    0.562892,    0.565652,    0.569353,
    0.999958,    0.999999,    0.999999,    0.999999,    0.999999,
    0.999999,    0.999999,    0.999999,    0.999999,    0.999999,
    0.999999,    0.999999,    0.999999,    0.999997,    0.99998,
    0.246677,    0.969193,    0.998564,    0.999711,    0.999878,
    0.999929,    0.999949,    0.999959,    0.999965,    0.999965,
    0.999962,    0.999952,    0.999938,    0.999905,    0.999778,
    0.998474,    0.249268,    0.910291,    0.973267,    0.992312,
    0.997261,    0.998707,    0.999214,    0.999459,    0.999565,
    0.999622,    0.999628,    0.999591,    0.99949,     0.999214,
    0.998267,    0.988768,    0.262812,    0.912848,    0.92862,
    0.962469,    0.981094,    0.989585,    0.993905,    0.996162,
    0.997246,    0.997853,    0.998068,    0.998069,    0.997753,
    0.996786,    0.993333,    0.962522,    0.299911,    0.928699,
    0.903,       0.92599,     0.949025,    0.965834,    0.977028,
    0.983897,    0.98828,     0.990984,    0.99259,     0.993165,
    0.992777,    0.990519,    0.982086,    0.921138,    0.364459,
    0.939076,    0.896849,    0.899391,    0.916042,    0.933387,
    0.947999,    0.95981,     0.968535,    0.974586,    0.978547,
    0.98072,     0.980772,    0.97702,     0.961686,    0.876178,
    0.437196,    0.942599,    0.896255,    0.883986,    0.889039,
    0.901102,    0.914628,    0.92727,     0.938227,    0.947087,
    0.953579,    0.95744,     0.958008,    0.952541,    0.930391,
    0.835693,    0.504282,    0.940868,    0.893859,    0.87285,
    0.86792,     0.872067,    0.880897,    0.89143,     0.901607,
    0.910658,    0.917959,    0.922546,    0.923075,    0.915763,
    0.888985,    0.799602,    0.557536,    0.935161,    0.886996,
    0.860653,    0.848368,    0.845282,    0.848114,    0.854372,
    0.861633,    0.868624,    0.874382,    0.877886,    0.877179,
    0.868175,    0.8402,      0.764744,    0.59366,     0.926364,
    0.875362,    0.844802,    0.826957,    0.8179,      0.815154,
    0.816557,    0.819612,    0.823165,    0.825932,    0.826703,
    0.823764,    0.813368,    0.787416,    0.728711,    0.612143,
    0.915064,    0.859408,    0.824518,    0.801955,    0.787857,
    0.780315,    0.777263,    0.77606,     0.775546,    0.77482,
    0.772463,    0.767099,    0.755917,    0.733968,    0.691425,
    0.615386,    0.901688,    0.839815,    0.8001,      0.77303,
    0.754548,    0.742731,    0.735888,    0.730911,    0.726897,
    0.722744,    0.717801,    0.710795,    0.69985,     0.682159,
    0.653011,    0.606172,    0.886583,    0.817298,    0.77232,
    0.740688,    0.71809,     0.702774,    0.69275,     0.684825,
    0.67804,     0.671621,    0.664795,    0.657369,    0.647882,
    0.634931,    0.616292,    0.589577,    0.87006,     0.79247,
    0.741866,    0.705771,    0.679632,    0.6612,      0.64895,
    0.639047,    0.630579,    0.622964,    0.615775,    0.608946,
    0.601905,    0.593633,    0.583621,    0.570134,    0.852377,
    0.765946,    0.709596,    0.669439,    0.640042,    0.619449,
    0.605818,    0.594858,    0.585884,    0.578219,    0.571778,
    0.566677,    0.562665,    0.559124,    0.555507,    0.551392,
    0.833805,    0.738283,    0.676574,    0.632853,    0.600854,
    0.578841,    0.564668,    0.553672,    0.545073,    0.538446,
    0.53362,     0.530995,    0.530211,    0.530886,    0.532718,
    0.535536,    0.999958,    0.999999,    0.999999,    0.999999,
    0.999999,    0.999999,    0.999999,    0.999999,    0.999999,
    0.999999,    0.999999,    0.999998,    0.999997,    0.999993,
    0.999608,    0.18298,     0.96913,     0.998539,    0.999692,
    0.999864,    0.999915,    0.999933,    0.999945,    0.99995,
    0.999947,    0.999939,    0.999926,    0.999894,    0.999811,
    0.999443,    0.972249,    0.184142,    0.909858,    0.973074,
    0.992176,    0.997147,    0.998598,    0.999107,    0.999345,
    0.999444,    0.999489,    0.999465,    0.999373,    0.999146,
    0.998514,    0.995744,    0.87845,     0.190786,    0.911516,
    0.92793,     0.961964,    0.980657,    0.989177,    0.993491,
    0.995732,    0.996788,    0.997336,    0.997449,    0.997241,
    0.99645,     0.994164,    0.984301,    0.790679,    0.209487,
    0.92597,     0.901305,    0.924686,    0.947885,    0.964754,
    0.975927,    0.982738,    0.987065,    0.989623,    0.990945,
    0.990963,    0.989338,    0.983751,    0.960877,    0.738201,
    0.246041,    0.934507,    0.89357,     0.896721,    0.913653,
    0.931092,    0.945639,    0.957314,    0.965915,    0.971654,
    0.975009,    0.976019,    0.973563,    0.963443,    0.924807,
    0.709131,    0.299464,    0.935807,    0.890853,    0.879323,
    0.884749,    0.896906,    0.910281,    0.922637,    0.933356,
    0.941654,    0.947079,    0.94891,     0.945274,    0.93007,
    0.879158,    0.691172,    0.363885,    0.931486,    0.885893,
    0.865623,    0.861043,    0.86524,     0.873733,    0.88377,
    0.893555,    0.901713,    0.907363,    0.908919,    0.903519,
    0.883926,    0.828179,    0.67568,     0.42259,     0.922869,
    0.876089,    0.850394,    0.838338,    0.835139,    0.837376,
    0.842815,    0.849509,    0.855267,    0.858796,    0.858382,
    0.850516,    0.828272,    0.775071,    0.657813,    0.470085,
    0.910875,    0.861206,    0.831157,    0.813347,    0.803921,
    0.800226,    0.80044,     0.802795,    0.804841,    0.804977,
    0.801316,    0.790809,    0.76794,     0.721998,    0.635692,
    0.502605,    0.896134,    0.841781,    0.80728,     0.784524,
    0.769775,    0.760885,    0.756276,    0.754325,    0.75222,
    0.748783,    0.742046,    0.72959,     0.707891,    0.671104,
    0.609526,    0.519764,    0.87914,     0.818601,    0.779193,
    0.751722,    0.732319,    0.718786,    0.71009,     0.704534,
    0.699094,    0.692514,    0.683696,    0.670639,    0.651398,
    0.623132,    0.581706,    0.524474,    0.860303,    0.792474,
    0.747774,    0.715662,    0.691949,    0.674605,    0.662562,
    0.654373,    0.646641,    0.638448,    0.628714,    0.616566,
    0.600975,    0.580942,    0.554666,    0.52024,     0.840004,
    0.764115,    0.713889,    0.677367,    0.649959,    0.629428,
    0.61517,     0.605603,    0.596911,    0.588409,    0.579448,
    0.56935,     0.55806,     0.545298,    0.530293,    0.511804,
    0.818598,    0.734258,    0.678545,    0.637982,    0.607513,
    0.584844,    0.569382,    0.559582,    0.55122,     0.543676,
    0.536498,    0.529335,    0.522519,    0.516251,    0.509948,
    0.502767,    0.796429,    0.703552,    0.642738,    0.598771,
    0.566125,    0.542184,    0.526486,    0.51759,     0.510602,
    0.504977,    0.500353,    0.496573,    0.49408,     0.49332,
    0.493843,    0.495349,    0.999957,    0.999998,    0.999999,
    0.999999,    0.999999,    0.999999,    0.999999,    0.999999,
    0.999999,    0.999999,    0.999998,    0.999997,    0.999995,
    0.999974,    0.203057,    0.13295,     0.969046,    0.998506,
    0.999669,    0.999844,    0.999896,    0.999914,    0.999924,
    0.999926,    0.999919,    0.999906,    0.999876,    0.999812,
    0.9996,      0.997933,    0.211494,    0.133689,    0.909283,
    0.972827,    0.992,       0.996995,    0.998454,    0.998963,
    0.999192,    0.999273,    0.999288,    0.999213,    0.999012,
    0.998509,    0.996905,    0.984859,    0.254807,    0.137844,
    0.909777,    0.927029,    0.961303,    0.980091,    0.988645,
    0.992952,    0.995151,    0.996142,    0.996588,    0.996496,
    0.995872,    0.994067,    0.988263,    0.949948,    0.330127,
    0.148701,    0.922385,    0.899091,    0.922982,    0.946398,
    0.963341,    0.9745,      0.981192,    0.985327,    0.987615,
    0.98841,     0.987342,    0.983146,    0.969199,    0.895464,
    0.405317,    0.17061,     0.928506,    0.889282,    0.893237,
    0.910524,    0.928081,    0.942571,    0.95399,     0.962174,
    0.967341,    0.969593,    0.968402,    0.960951,    0.936246,
    0.835624,    0.462062,    0.206525,    0.926886,    0.883772,
    0.873243,    0.879133,    0.891407,    0.904621,    0.916489,
    0.926431,    0.933702,    0.937206,    0.935363,    0.923931,
    0.889019,    0.779662,    0.499776,    0.255089,    0.91918,
    0.875411,    0.856181,    0.852087,    0.856314,    0.864451,
    0.873615,    0.882145,    0.888739,    0.891552,    0.887927,
    0.872455,    0.831243,    0.728519,    0.521213,    0.306961,
    0.906775,    0.861743,    0.836956,    0.825284,    0.821941,
    0.823517,    0.827604,    0.832467,    0.836146,    0.836052,
    0.829408,    0.810542,    0.768104,    0.680391,    0.529069,
    0.355261,    0.89066,     0.842652,    0.813302,    0.795672,
    0.785856,    0.781122,    0.779456,    0.779416,    0.779061,
    0.775191,    0.765067,    0.74418,     0.704662,    0.634787,
    0.526094,    0.393526,    0.871538,    0.818822,    0.784821,
    0.761969,    0.746575,    0.736297,    0.72932,     0.724593,
    0.720154,    0.712908,    0.700374,    0.679343,    0.64512,
    0.591692,    0.515495,    0.419975,    0.849988,    0.791172,
    0.752148,    0.724348,    0.704091,    0.689032,    0.677624,
    0.669113,    0.661811,    0.652237,    0.638941,    0.619648,
    0.59189,     0.55282,     0.500527,    0.435659,    0.826551,
    0.760677,    0.716384,    0.683858,    0.659269,    0.640309,
    0.625543,    0.614513,    0.605818,    0.595787,    0.583327,
    0.567213,    0.54602,     0.51876,     0.484843,    0.44359,
    0.801718,    0.728203,    0.678573,    0.641801,    0.613668,
    0.591627,    0.574604,    0.562522,    0.553946,    0.544924,
    0.53481,     0.52286,     0.508248,    0.490479,    0.470466,
    0.447193,    0.775966,    0.694627,    0.639958,    0.599472,
    0.56846,     0.54449,     0.526495,    0.514616,    0.507557,
    0.500848,    0.493988,    0.486508,    0.478089,    0.468666,
    0.459067,    0.449247,    0.749761,    0.66076,     0.601351,
    0.558056,    0.52524,     0.500383,    0.482396,    0.471848,
    0.467356,    0.463835,    0.460872,    0.458108,    0.455266,
    0.452585,    0.45126,     0.451576,    0.999956,    0.999998,
    0.999999,    0.999999,    0.999999,    0.999999,    0.999999,
    0.999999,    0.999999,    0.999998,    0.999997,    0.999996,
    0.999986,    0.997789,    0.119105,    0.0942918,   0.96895,
    0.998467,    0.999642,    0.999822,    0.999874,    0.999893,
    0.999901,    0.999898,    0.999884,    0.999858,    0.999798,
    0.999639,    0.998914,    0.903682,    0.121726,    0.0947183,
    0.908609,    0.972533,    0.99179,     0.996814,    0.998287,
    0.998791,    0.999002,    0.999051,    0.999011,    0.998834,
    0.998397,    0.997192,    0.991795,    0.777418,    0.13359,
    0.0972097,   0.907698,    0.925951,    0.96051,     0.979405,
    0.987998,    0.992294,    0.994432,    0.995294,    0.995529,
    0.995053,    0.993558,    0.989203,    0.970654,    0.704271,
    0.163061,    0.104543,    0.91808,     0.896397,    0.920905,
    0.944576,    0.961601,    0.972716,    0.979253,    0.983051,
    0.984776,    0.984566,    0.981276,    0.970914,    0.93065,
    0.661953,    0.212358,    0.119749,    0.921246,    0.88402,
    0.888929,    0.906642,    0.924331,    0.938719,    0.949778,
    0.95725,     0.961232,    0.961454,    0.95592,     0.937401,
    0.875154,    0.6347,      0.272293,    0.144945,    0.916024,
    0.875043,    0.865665,    0.872095,    0.884493,    0.897466,
    0.908671,    0.91732,     0.922524,    0.922643,    0.913975,
    0.887083,    0.811844,    0.612674,    0.327055,    0.180005,
    0.904149,    0.862447,    0.844369,    0.840787,    0.845013,
    0.852649,    0.860717,    0.867238,    0.870731,    0.868781,
    0.856322,    0.82343,     0.746916,    0.588053,    0.371226,
    0.221258,    0.887085,    0.843931,    0.820152,    0.808793,
    0.805192,    0.80591,     0.808385,    0.810421,    0.81005,
    0.804313,    0.78806,     0.752741,    0.683472,    0.560373,
    0.400319,    0.263235,    0.865934,    0.81958,     0.79102,
    0.773406,    0.762984,    0.756969,    0.75319,     0.749656,
    0.744623,    0.735047,    0.716011,    0.681661,    0.623022,
    0.532104,    0.415438,    0.300685,    0.841517,    0.790282,
    0.75685,     0.733761,    0.717429,    0.705488,    0.696015,
    0.687364,    0.678131,    0.665933,    0.646298,    0.61554,
    0.568701,    0.503315,    0.420057,    0.330815,    0.814569,
    0.757185,    0.718611,    0.690446,    0.669081,    0.652464,
    0.638612,    0.625987,    0.614206,    0.601067,    0.582772,
    0.557177,    0.52232,     0.476056,    0.418257,    0.353425,
    0.785795,    0.721481,    0.677692,    0.644956,    0.619688,
    0.599035,    0.581782,    0.566953,    0.554411,    0.542563,
    0.527557,    0.508308,    0.483592,    0.452332,    0.413847,
    0.370196,    0.755864,    0.68426,     0.635383,    0.599219,
    0.570274,    0.546901,    0.527833,    0.512353,    0.500774,
    0.491723,    0.481173,    0.468423,    0.45276,     0.433327,
    0.409684,    0.383413,    0.725402,    0.64662,     0.593873,
    0.553866,    0.52262,     0.497806,    0.478295,    0.463447,
    0.454095,    0.449001,    0.443486,    0.437068,    0.429322,
    0.419569,    0.40736,     0.394942,    0.694994,    0.609614,
    0.553052,    0.510655,    0.478078,    0.452965,    0.434052,
    0.420909,    0.414701,    0.414182,    0.413927,    0.413548,
    0.412559,    0.410627,    0.407496,    0.405436,    0.999954,
    0.999997,    0.999998,    0.999998,    0.999999,    0.999999,
    0.999999,    0.999998,    0.999997,    0.999997,    0.999996,
    0.999989,    0.999898,    0.147506,    0.0779148,   0.0661737,
    0.968812,    0.998413,    0.999605,    0.999788,    0.999842,
    0.99986,     0.999863,    0.999853,    0.999822,    0.999764,
    0.99962,     0.999111,    0.99205,     0.153498,    0.0783978,
    0.0664327,   0.907684,    0.972127,    0.991496,    0.996563,
    0.998044,    0.998535,    0.998721,    0.998707,    0.998545,
    0.998122,    0.99705,     0.99324,     0.94879,     0.182807,
    0.0831496,   0.0679308,   0.904882,    0.924495,    0.959431,
    0.978461,    0.987081,    0.991334,    0.993352,    0.993986,
    0.993773,    0.992386,    0.988558,    0.975188,    0.867904,
    0.24062,     0.0967958,   0.0724304,   0.912301,    0.892808,
    0.918125,    0.942103,    0.959184,    0.970175,    0.976392,
    0.979578,    0.980141,    0.977594,    0.968635,    0.938666,
    0.784945,    0.307977,    0.123278,    0.0820745,   0.911593,
    0.877075,    0.883222,    0.901448,    0.919205,    0.9333,
    0.943668,    0.94986,     0.951481,    0.947127,    0.931284,
    0.882845,    0.716745,    0.363771,    0.161736,    0.0986719,
    0.901718,    0.863611,    0.855723,    0.862786,    0.875175,
    0.887573,    0.897533,    0.903955,    0.905184,    0.898055,
    0.874743,    0.813419,    0.660099,    0.400404,    0.206987,
    0.123343,    0.884539,    0.845624,    0.829027,    0.826011,
    0.830026,    0.836671,    0.842779,    0.845975,    0.843827,
    0.832393,    0.80313,     0.738226,    0.6093,      0.418843,
    0.250634,    0.154158,    0.861659,    0.821081,    0.79856,
    0.787523,    0.78337,     0.782596,    0.782377,    0.780118,
    0.772855,    0.756598,    0.724264,    0.663553,    0.562066,
    0.423059,    0.285765,    0.187906,    0.83434,     0.790344,
    0.762746,    0.745115,    0.73377,     0.725833,    0.718843,
    0.710447,    0.698081,    0.678427,    0.64635,     0.594514,
    0.517165,    0.417228,    0.311131,    0.221088,    0.803632,
    0.754645,    0.721925,    0.69857,     0.681102,    0.667001,
    0.654145,    0.640666,    0.62455,     0.603811,    0.574905,
    0.533159,    0.476589,    0.405502,    0.327199,    0.251423,
    0.770504,    0.715458,    0.677526,    0.649082,    0.626389,
    0.607448,    0.590301,    0.573466,    0.555669,    0.536043,
    0.512486,    0.481269,    0.441204,    0.392263,    0.336992,
    0.278023,    0.73589,     0.674267,    0.631437,    0.598334,
    0.571678,    0.54925,     0.529456,    0.511215,    0.493846,
    0.47735,     0.460275,    0.438736,    0.412137,    0.380675,
    0.34375,     0.301447,    0.700691,    0.632468,    0.58498,
    0.548353,    0.518864,    0.494458,    0.473667,    0.455685,
    0.440232,    0.427958,    0.417649,    0.405227,    0.390233,
    0.372043,    0.349953,    0.322755,    0.665698,    0.59134,
    0.539907,    0.500691,    0.46956,     0.444404,    0.42396,
    0.407467,    0.39495,     0.387627,    0.384333,    0.380096,
    0.374561,    0.367214,    0.357055,    0.34262,     0.63166,
    0.551848,    0.497267,    0.456384,    0.42475,     0.400021,
    0.380959,    0.366816,    0.357792,    0.355583,    0.358943,
    0.362141,    0.364763,    0.366245,    0.365623,    0.361897,
    0.999951,    0.999996,    0.999997,    0.999997,    0.999998,
    0.999998,    0.999997,    0.999997,    0.999996,    0.999995,
    0.99999,     0.999942,    0.204563,    0.0732728,   0.0494646,
    0.0432447,   0.968653,    0.998348,    0.999557,    0.999744,
    0.999802,    0.999816,    0.999811,    0.999787,    0.99972,
    0.999574,    0.999111,    0.995327,    0.218259,    0.074372,
    0.0492468,   0.0434073,   0.906585,    0.971645,    0.991142,
    0.996247,    0.997732,    0.998198,    0.998317,    0.998178,
    0.997751,    0.996668,    0.993222,    0.967407,    0.270583,
    0.0826802,   0.0517588,   0.0444559,   0.901523,    0.922731,
    0.958102,    0.977273,    0.985896,    0.990044,    0.991826,
    0.99198,     0.990785,    0.986984,    0.974911,    0.90325,
    0.34296,     0.103937,    0.0591877,   0.0476703,   0.905368,
    0.888413,    0.914662,    0.938961,    0.956033,    0.966742,
    0.972322,    0.974276,    0.972343,    0.96391,     0.936831,
    0.820769,    0.398215,    0.140576,    0.0740658,   0.0545577,
    0.89998,     0.868518,    0.876076,    0.894806,    0.912489,
    0.925964,    0.935019,    0.938727,    0.935485,    0.920452,
    0.876572,    0.740991,    0.428485,    0.187084,    0.0981405,
    0.0664028,   0.884484,    0.849474,    0.843219,    0.850849,
    0.86297,     0.874236,    0.881933,    0.884242,    0.877874,
    0.855631,    0.799672,    0.668958,    0.438558,    0.23314,
    0.129093,    0.0846556,   0.860939,    0.824806,    0.809709,
    0.807098,    0.810485,    0.815334,    0.818127,    0.815642,
    0.803732,    0.775002,    0.715265,    0.602932,    0.433462,
    0.269605,    0.16318,     0.107754,    0.831181,    0.792902,
    0.771456,    0.760462,    0.755212,    0.752006,    0.74761,
    0.738656,    0.720874,    0.688157,    0.631534,    0.539494,
    0.417987,    0.292207,    0.195494,    0.133836,    0.796735,
    0.754574,    0.727544,    0.70955,     0.696656,    0.685705,
    0.674003,    0.658565,    0.63573,     0.601797,    0.552405,
    0.483702,    0.396424,    0.30281,     0.222958,    0.162063,
    0.758991,    0.711524,    0.679035,    0.65469,     0.634531,
    0.617215,    0.599926,    0.580313,    0.556001,    0.524639,
    0.484846,    0.434508,    0.373113,    0.306516,    0.244895,
    0.191298,    0.719243,    0.665678,    0.627641,    0.59724,
    0.572934,    0.551237,    0.530379,    0.508827,    0.485215,
    0.458382,    0.427941,    0.392872,    0.351483,    0.30674,
    0.262589,    0.219913,    0.678753,    0.618935,    0.574737,
    0.54143,     0.513661,    0.489363,    0.467041,    0.445624,
    0.424399,    0.402743,    0.381407,    0.359371,    0.333719,
    0.306466,    0.277678,    0.247363,    0.638621,    0.570609,
    0.52448,     0.488372,    0.458634,    0.43328,     0.411104,
    0.39132,     0.373429,    0.357335,    0.344164,    0.333781,
    0.321651,    0.307705,    0.292057,    0.273789,    0.599492,
    0.526249,    0.477229,    0.439405,    0.408963,    0.383907,
    0.363037,    0.345635,    0.331558,    0.321395,    0.31641,
    0.315757,    0.314168,    0.311499,    0.307304,    0.299492,
    0.55948,     0.484821,    0.433749,    0.395286,    0.365175,
    0.341377,    0.322738,    0.308731,    0.298923,    0.293803,
    0.295708,    0.303628,    0.31116,     0.317967,    0.323371,
    0.32499,     0.99995,     0.999995,    0.999996,    0.999997,
    0.999997,    0.999997,    0.999996,    0.999996,    0.999994,
    0.999987,    0.99994,     0.236505,    0.0712487,   0.0392064,
    0.0294337,   0.0272239,   0.968428,    0.998257,    0.999489,
    0.999683,    0.999737,    0.999741,    0.999717,    0.999646,
    0.999477,    0.998962,    0.995163,    0.255233,    0.0737104,
    0.0399645,   0.0298214,   0.027338,    0.905026,    0.970943,
    0.990617,    0.99577,     0.997236,    0.99763,     0.9976,
    0.997134,    0.99591,     0.992051,    0.966219,    0.317291,
    0.0841422,   0.0432289,   0.0313037,   0.028053,    0.896753,
    0.920169,    0.956131,    0.975459,    0.984025,    0.98791,
    0.989117,    0.988072,    0.983959,    0.970599,    0.899159,
    0.384818,    0.109753,    0.0523326,   0.0354129,   0.0301945,
    0.895539,    0.882062,    0.909535,    0.934178,    0.95107,
    0.961078,    0.965183,    0.964104,    0.955135,    0.925996,
    0.811201,    0.424164,    0.150535,    0.0699772,   0.0436474,
    0.034796,    0.883537,    0.856202,    0.865538,    0.884755,
    0.901978,    0.914005,    0.920106,    0.917983,    0.902214,
    0.855807,    0.723257,    0.437358,    0.197138,    0.0962561,
    0.0575982,   0.042849,    0.860175,    0.829268,    0.824942,
    0.832958,    0.844106,    0.852861,    0.855753,    0.849143,
    0.825505,    0.767629,    0.641258,    0.43154,     0.237019,
    0.127646,    0.0772486,   0.0550494,   0.827815,    0.795308,
    0.781808,    0.779152,    0.780847,    0.782005,    0.778269,
    0.764658,    0.733669,    0.672543,    0.56473,     0.412554,
    0.262789,    0.158973,    0.100453,    0.0714346,   0.788686,
    0.753372,    0.732954,    0.721224,    0.713441,    0.705611,
    0.693726,    0.673175,    0.638167,    0.58105,     0.495044,
    0.385641,    0.273907,    0.18473,     0.125082,    0.0914328,
    0.744797,    0.705023,    0.678502,    0.659358,    0.644284,
    0.629102,    0.610113,    0.584684,    0.548586,    0.498832,
    0.433232,    0.354938,    0.274277,    0.203652,    0.149818,
    0.115398,    0.698035,    0.652701,    0.621313,    0.596711,
    0.574626,    0.55316,     0.529902,    0.502733,    0.469631,
    0.428661,    0.379452,    0.324631,    0.268871,    0.216756,
    0.173848,    0.14273,     0.650172,    0.598915,    0.563811,
    0.533577,    0.507238,    0.48256,     0.457811,    0.431553,
    0.402551,    0.370182,    0.33459,     0.297992,    0.261624,
    0.226476,    0.195908,    0.17264,     0.602787,    0.548594,
    0.507372,    0.473984,    0.445323,    0.41947,     0.39512,
    0.371176,    0.347121,    0.32283,     0.298566,    0.27567,
    0.255364,    0.235167,    0.216958,    0.203107,    0.560051,
    0.498911,    0.454747,    0.419565,    0.390148,    0.364713,
    0.342046,    0.321513,    0.302671,    0.284879,    0.269794,
    0.258772,    0.251575,    0.244323,    0.23781,     0.233784,
    0.518078,    0.453014,    0.407041,    0.371368,    0.342445,
    0.318467,    0.29837,     0.280726,    0.266717,    0.255665,
    0.248245,    0.246796,    0.250758,    0.254635,    0.25885,
    0.264302,    0.479842,    0.411612,    0.364797,    0.329507,
    0.30194,     0.279404,    0.262084,    0.248751,    0.239183,
    0.233474,    0.232487,    0.239126,    0.252723,    0.266313,
    0.280247,    0.294494,    0.999945,    0.999994,    0.999995,
    0.999996,    0.999996,    0.999995,    0.999995,    0.999992,
    0.999982,    0.999891,    0.193016,    0.062532,    0.0312312,
    0.0202775,   0.0165357,   0.0153649,   0.968123,    0.998126,
    0.999388,    0.999588,    0.99963,     0.999608,    0.999521,
    0.999296,    0.998543,    0.991442,    0.207329,    0.0641609,
    0.0316624,   0.0204871,   0.0166499,   0.0154294,   0.90291,
    0.969963,    0.989851,    0.995034,    0.996425,    0.996615,
    0.996114,    0.99446,     0.988924,    0.944375,    0.257482,
    0.0740035,   0.0349642,   0.0219876,   0.0173009,   0.0158454,
    0.890268,    0.916591,    0.953266,    0.972692,    0.980962,
    0.984071,    0.983559,    0.978237,    0.959654,    0.853404,
    0.323472,    0.0979398,   0.0440148,   0.0262121,   0.0194772,
    0.0172129,   0.882193,    0.873199,    0.902114,    0.926902,
    0.943006,    0.951032,    0.950868,    0.939718,    0.900966,
    0.753101,    0.368499,    0.135386,    0.0610159,   0.0346844,
    0.0242431,   0.0204086,   0.86131,     0.839069,    0.850374,
    0.869604,    0.885163,    0.893286,    0.891405,    0.872053,
    0.814204,    0.660445,    0.385172,    0.176299,    0.0851943,
    0.0480562,   0.0322817,   0.0262533,   0.827529,    0.801376,
    0.798895,    0.806416,    0.814644,    0.817218,    0.808392,
    0.779285,    0.711379,    0.576016,    0.379364,    0.208785,
    0.112229,    0.0656435,   0.043956,    0.0352242,   0.783829,
    0.755102,    0.742718,    0.738667,    0.736108,    0.729193,
    0.711541,    0.674652,    0.607379,    0.498271,    0.358227,
    0.226328,    0.136519,    0.0850529,   0.0589962,   0.0480179,
    0.733139,    0.700537,    0.680364,    0.666748,    0.654109,
    0.637838,    0.613085,    0.572943,    0.512185,    0.428344,
    0.328083,    0.22971,     0.153607,    0.104784,    0.0768518,
    0.0649069,   0.678275,    0.640465,    0.614989,    0.593474,
    0.57251,     0.548707,    0.519012,    0.480541,    0.429625,
    0.366086,    0.29472,     0.2236,      0.164555,    0.12279,
    0.0967955,   0.0858233,   0.621884,    0.581028,    0.548119,
    0.520176,    0.493998,    0.466961,    0.436854,    0.401646,
    0.360302,    0.313229,    0.262416,    0.212924,    0.170519,
    0.138866,    0.118183,    0.110445,    0.569821,    0.520662,
    0.483476,    0.451942,    0.423222,    0.395316,    0.366678,
    0.336322,    0.304025,    0.269836,    0.234881,    0.201704,
    0.173948,    0.15369,     0.14061,     0.138123,    0.51742,
    0.464091,    0.424031,    0.390754,    0.3615,      0.334506,
    0.308818,    0.283263,    0.259772,    0.235534,    0.212503,
    0.191975,    0.176803,    0.168015,    0.163854,    0.168161,
    0.469432,    0.412733,    0.37118,     0.337644,    0.309158,
    0.283838,    0.263419,    0.243397,    0.225245,    0.209017,
    0.195149,    0.184633,    0.180177,    0.182336,    0.187608,
    0.199655,    0.426304,    0.367171,    0.32519,     0.292197,
    0.267441,    0.245358,    0.226912,    0.211483,    0.198832,
    0.188974,    0.182306,    0.179793,    0.184544,    0.196899,
    0.211521,    0.231694,    0.388167,    0.327365,    0.285427,
    0.256586,    0.232404,    0.213345,    0.198422,    0.187054,
    0.178981,    0.17422,     0.173218,    0.1772,      0.189969,
    0.211725,    0.235268,    0.263393,    0.999941,    0.999992,
    0.999994,    0.999995,    0.999994,    0.999992,    0.999985,
    0.999965,    0.997853,    0.11144,     0.042065,    0.0208756,
    0.0126811,   0.00914491,  0.00778053,  0.00729162,  0.967664,
    0.997923,    0.999221,    0.999412,    0.99941,     0.999277,
    0.99887,     0.997122,    0.903769,    0.117372,    0.0432186,
    0.0212444,   0.0128259,   0.00921099,  0.00784317,  0.00733462,
    0.899746,    0.968422,    0.988566,    0.993682,    0.994738,
    0.994083,    0.991174,    0.978651,    0.764487,    0.143435,
    0.0498871,   0.0237939,   0.0139936,   0.00985708,  0.00821743,
    0.00761951,  0.880601,    0.910972,    0.948464,    0.967622,
    0.974648,    0.974683,    0.965764,    0.927124,    0.667105,
    0.191873,    0.0666504,   0.0307168,   0.0173274,   0.0117574,
    0.00944653,  0.00850538,  0.862365,    0.859315,    0.889733,
    0.913724,    0.92669,     0.927309,    0.908461,    0.838228,
    0.59188,     0.241743,    0.0939397,   0.0435471,   0.023934,
    0.0155934,   0.0121877,   0.0104692,   0.828499,    0.812483,
    0.825381,    0.842715,    0.852287,    0.847278,    0.816151,
    0.726576,    0.523293,    0.272117,    0.125019,    0.0614384,
    0.0340566,   0.0218502,   0.0169435,   0.014226,    0.779926,
    0.758755,    0.756988,    0.760861,    0.759995,    0.74467,
    0.701729,    0.61025,     0.454912,    0.277559,    0.15045,
    0.080778,    0.0467942,   0.0308134,   0.0244491,   0.0207587,
    0.720821,    0.695156,    0.682014,    0.672578,    0.658935,
    0.63281,     0.584304,    0.503555,    0.38958,     0.265399,
    0.163626,    0.0974593,   0.0605522,   0.0420196,   0.0346721,
    0.0303879,   0.655529,    0.624565,    0.602557,    0.582276,
    0.557975,    0.524905,    0.477671,    0.411304,    0.328115,
    0.241701,    0.165135,    0.108857,    0.0735949,   0.0549366,
    0.047768,    0.0432957,   0.588201,    0.552054,    0.522288,
    0.494678,    0.465387,    0.430577,    0.387265,    0.334544,
    0.274264,    0.214609,    0.159187,    0.115108,    0.0852583,
    0.068958,    0.0634768,   0.0598747,   0.523775,    0.481366,
    0.447047,    0.415763,    0.384425,    0.350832,    0.313727,
    0.273739,    0.231545,    0.188817,    0.149866,    0.117972,
    0.095393,    0.0835521,   0.0813942,   0.080093,    0.462783,
    0.416621,    0.379888,    0.34733,     0.316593,    0.286268,
    0.257337,    0.226456,    0.195773,    0.166462,    0.140894,
    0.119132,    0.104291,    0.0982542,   0.101011,    0.103641,
    0.408002,    0.359467,    0.321981,    0.289888,    0.263243,
    0.236987,    0.212392,    0.189245,    0.167685,    0.147861,
    0.132506,    0.119777,    0.112311,    0.112782,    0.121692,
    0.129927,    0.360155,    0.310615,    0.273898,    0.245235,
    0.219572,    0.197325,    0.177842,    0.160747,    0.1459,
    0.135419,    0.126172,    0.120557,    0.119728,    0.126928,
    0.142606,    0.157465,    0.319611,    0.271422,    0.235761,
    0.207769,    0.185168,    0.166637,    0.151382,    0.140961,
    0.131732,    0.125195,    0.121673,    0.121739,    0.126693,
    0.140307,    0.163637,    0.186751,    0.285833,    0.237495,
    0.203327,    0.177855,    0.15829,     0.14339,     0.133673,
    0.125545,    0.120316,    0.117975,    0.118772,    0.123354,
    0.133238,    0.15316,     0.184777,    0.216872,    0.999927,
    0.999986,    0.999988,    0.999988,    0.999982,    0.999965,
    0.999571,    0.127015,    0.0417134,   0.0183922,   0.00947774,
    0.00557893,  0.00382864,  0.00293462,  0.00256596,  0.00244013,
    0.966824,    0.997511,    0.99883,     0.998919,    0.998577,
    0.997047,    0.96905,     0.136306,    0.0432106,   0.0188668,
    0.00974319,  0.00571148,  0.00385122,  0.00298615,  0.00256976,
    0.0024604,   0.893949,    0.965302,    0.9856,      0.989924,
    0.988431,    0.977712,    0.855433,    0.173615,    0.0516317,
    0.0218407,   0.0110381,   0.00640205,  0.00427591,  0.00325202,
    0.00274845,  0.00260322,  0.862914,    0.899658,    0.937472,
    0.953725,    0.951859,    0.920411,    0.724429,    0.2291,
    0.0714298,   0.029499,    0.014555,    0.00828318,  0.00546774,
    0.00405079,  0.00331555,  0.00306496,  0.826379,    0.831704,
    0.861951,    0.878895,    0.872172,    0.81526,     0.609841,
    0.268051,    0.0997263,   0.0425887,   0.0210032,   0.0119079,
    0.00795588,  0.0058281,   0.00463196,  0.00413465,  0.769916,
    0.760846,    0.771407,    0.776078,    0.755104,    0.67987,
    0.506048,    0.275356,    0.125639,    0.0586318,   0.0299788,
    0.0174976,   0.0121419,   0.00898121,  0.00705745,  0.0061746,
    0.697139,    0.679149,    0.671456,    0.657966,    0.622001,
    0.544294,    0.412872,    0.257462,    0.138837,    0.0727308,
    0.0400918,   0.0247204,   0.0181044,   0.0139211,   0.0111045,
    0.00955338,  0.615364,    0.589431,    0.567275,    0.53892,
    0.495595,    0.426294,    0.330081,    0.225688,    0.138455,
    0.0814225,   0.0493786,   0.0329807,   0.0256717,   0.020286,
    0.016875,    0.0147035,   0.532691,    0.498476,    0.467401,
    0.432781,    0.38812,     0.330303,    0.261967,    0.19067,
    0.129454,    0.0844855,   0.0568153,   0.0418902,   0.0344185,
    0.0287589,   0.0244313,   0.0221878,   0.45377,     0.414553,
    0.379285,    0.342592,    0.301818,    0.256584,    0.207225,
    0.158545,    0.116415,    0.0835217,   0.0622716,   0.0500921,
    0.0443796,   0.0392365,   0.0343333,   0.0321871,   0.383243,
    0.341676,    0.305297,    0.270163,    0.236027,    0.200359,
    0.164903,    0.132255,    0.103313,    0.0805575,   0.0660285,
    0.0574394,   0.0536832,   0.0499277,   0.0466459,   0.0454582,
    0.32308,     0.281119,    0.246684,    0.21516,     0.185865,
    0.158399,    0.13358,     0.11094,     0.0917986,   0.077027,
    0.0684948,   0.0637122,   0.0624156,   0.0607778,   0.0597784,
    0.0612083,   0.273887,    0.232938,    0.20034,     0.172726,
    0.148717,    0.128146,    0.109946,    0.0946785,   0.0825772,
    0.0740516,   0.0700792,   0.0687865,   0.0700988,   0.0711917,
    0.0735113,   0.078983,    0.234206,    0.194313,    0.164593,
    0.140863,    0.121602,    0.105576,    0.0926678,   0.0827062,
    0.0757068,   0.0723085,   0.0711585,   0.0728173,   0.0763437,
    0.0806529,   0.0875725,   0.0992134,   0.202177,    0.163955,
    0.137218,    0.117014,    0.101241,    0.0891552,   0.080237,
    0.074212,    0.0712783,   0.0703715,   0.071972,    0.0757946,
    0.0822798,   0.0899654,   0.102223,    0.121608,    0.176625,
    0.14015,     0.116175,    0.0988244,   0.0862277,   0.0773346,
    0.0718189,   0.0685446,   0.0676217,   0.0689724,   0.0726518,
    0.0785898,   0.0873512,   0.0984339,   0.116686,    0.145518,
    0.999894,    0.999964,    0.999952,    0.999766,    0.119744,
    0.0278951,   0.0103359,   0.00461456,  0.00232889,  0.00127058,
    0.000762095, 0.000496269, 0.00036633,  0.000295222, 0.000262825,
    0.000255723, 0.964016,    0.995619,    0.995702,    0.981748,
    0.136528,    0.029778,    0.0107976,   0.00479828,  0.00240693,
    0.00132129,  0.000789377, 0.00051788,  0.000378147, 0.000304291,
    0.000268512, 0.000259474, 0.874645,    0.95112,     0.962493,
    0.888332,    0.191489,    0.0389015,   0.0133563,   0.00580329,
    0.00292917,  0.00160969,  0.000961975, 0.000628584, 0.000451503,
    0.000357703, 0.000311986, 0.000294838, 0.805015,    0.849894,
    0.859601,    0.721918,    0.240237,    0.0575715,   0.019301,
    0.00832995,  0.0043992,   0.00246744,  0.00149024,  0.000972709,
    0.000690781, 0.000528873, 0.00044418,  0.000405677, 0.71308,
    0.718926,    0.697312,    0.543689,    0.242569,    0.0773068,
    0.0276708,   0.0126014,   0.00722931,  0.00423079,  0.00262922,
    0.0017362,   0.00123065,  0.000926209, 0.000737789, 0.000675566,
    0.597716,    0.57395,     0.52201,     0.393145,    0.209545,
    0.0861694,   0.0353773,   0.017981,    0.0114123,   0.00714965,
    0.00460441,  0.00312055,  0.00220054,  0.00165062,  0.00131778,
    0.00119817,  0.477144,    0.43615,     0.374612,    0.277433,
    0.16548,     0.082318,    0.0398181,   0.023294,    0.0164122,
    0.0110901,   0.00754898,  0.00532043,  0.00379954,  0.00287439,
    0.00229073,  0.00209459,  0.368203,    0.321091,    0.264226,
    0.195316,    0.125624,    0.0717327,   0.0407563,   0.0275441,
    0.0213049,   0.0156341,   0.0112029,   0.00826625,  0.00621372,
    0.00480369,  0.0037838,   0.00348812,  0.279586,    0.234127,
    0.18663,     0.138037,    0.0938869,   0.0599414,   0.0391275,
    0.0301283,   0.0253938,   0.0200072,   0.0153808,   0.0116857,
    0.00901336,  0.00732112,  0.00601965,  0.00561812,  0.212391,
    0.171506,    0.133864,    0.0996244,   0.0705531,   0.0491962,
    0.0362924,   0.0310787,   0.0282302,   0.0239365,   0.0195133,
    0.0157074,   0.012613,    0.0102811,   0.00881602,  0.00845778,
    0.162687,    0.127738,    0.0981505,   0.0734351,   0.0541264,
    0.0406336,   0.0332312,   0.0308449,   0.0297322,   0.0268591,
    0.0232602,   0.019725,    0.0166192,   0.0140593,   0.0121929,
    0.0120453,   0.126845,    0.096979,    0.0737234,   0.0557175,
    0.0425412,   0.0341768,   0.0302605,   0.0298778,   0.0301405,
    0.0287079,   0.026262,    0.0234521,   0.0207092,   0.0182857,
    0.0164382,   0.0167738,   0.100825,    0.0753231,   0.0569176,
    0.0435311,   0.0345269,   0.0294255,   0.0277245,   0.028596,
    0.0298276,   0.0296374,   0.0284173,   0.0266337,   0.0246327,
    0.0227401,   0.0212821,   0.0225949,   0.0818996,   0.059914,
    0.0451159,   0.0351354,   0.0289739,   0.0260015,   0.0256896,
    0.0272841,   0.0291227,   0.0298952,   0.0298044,   0.0291495,
    0.0281744,   0.0271805,   0.0265837,   0.0295338,   0.0679726,
    0.0487055,   0.0367534,   0.0292911,   0.0251226,   0.0235869,
    0.0241218,   0.026088,    0.0282742,   0.029732,    0.0305881,
    0.0310154,   0.0311999,   0.0314064,   0.0321387,   0.0375162,
    0.0575748,   0.0404637,   0.0307656,   0.0251798,   0.0224699,
    0.0218987,   0.0229388,   0.025071,    0.0274272,   0.0293486,
    0.0309343,   0.032321,    0.0336768,   0.0352547,   0.0377049,
    0.0464721};

#define SHEEN_LUT_SIZE 16
__constant__ float SHEEN_LUT[] = {
    0.966765, 0.605588, 0.457547, 0.369858, 0.310205, 0.266845, 0.234127,
    0.208952, 0.189582, 0.175974, 0.167246, 0.162883, 0.16278,  0.167335,
    0.177701, 0.196602, 0.819144, 0.550113, 0.437399, 0.369537, 0.322456,
    0.287227, 0.259637, 0.237397, 0.219345, 0.20579,  0.196067, 0.189444,
    0.185793, 0.185048, 0.187513, 0.194,    0.820713, 0.564793, 0.45683,
    0.391578, 0.346072, 0.311852, 0.284764, 0.262625, 0.244346, 0.230323,
    0.21974,  0.211903, 0.20648,  0.203125, 0.201946, 0.203346, 0.856484,
    0.596866, 0.486984, 0.42043,  0.373897, 0.338726, 0.310734, 0.287712,
    0.268503, 0.253559, 0.241958, 0.232924, 0.225965, 0.220781, 0.21729,
    0.215629, 0.905717, 0.635889, 0.521241, 0.451757, 0.403093, 0.366194,
    0.336706, 0.31229,  0.29182,  0.275722, 0.262976, 0.252725, 0.24439,
    0.23767,  0.232339, 0.228481, 0.960827, 0.677496, 0.556793, 0.483612,
    0.432245, 0.393207, 0.361921, 0.335923, 0.314019, 0.296619, 0.28268,
    0.271209, 0.261604, 0.253498, 0.246661, 0.241114, 1,        0.719438,
    0.59212,  0.514777, 0.460496, 0.419129, 0.385903, 0.35822,  0.334833,
    0.316129, 0.300931, 0.288242, 0.277439, 0.268107, 0.259974, 0.253057,
    1,        0.760246, 0.6261,   0.544516, 0.487206, 0.443465, 0.408268,
    0.378891, 0.354017, 0.333998, 0.317594, 0.30376,  0.291851, 0.281283,
    0.272087, 0.264024, 1,        0.798833, 0.657953, 0.57221,  0.511897,
    0.465826, 0.428705, 0.397687, 0.371384, 0.350118, 0.332581, 0.31768,
    0.304721, 0.293282, 0.282948, 0.273917, 1,        0.834305, 0.687035,
    0.597352, 0.534198, 0.485933, 0.446993, 0.414443, 0.386819, 0.36439,
    0.345797, 0.329921, 0.316043, 0.303681, 0.292639, 0.282756, 1,
    0.865948, 0.712834, 0.619542, 0.553808, 0.503531, 0.462961, 0.42901,
    0.400197, 0.376725, 0.357202, 0.340458, 0.32577,  0.312654, 0.300827,
    0.290317, 1,        0.893165, 0.734896, 0.638471, 0.570472, 0.518451,
    0.476441, 0.441301, 0.411449, 0.387083, 0.366754, 0.349263, 0.333893,
    0.320144, 0.307714, 0.29654,  1,        0.915436, 0.752919, 0.653878,
    0.584013, 0.530532, 0.487351, 0.451209, 0.420508, 0.395416, 0.374405,
    0.356326, 0.340414, 0.326147, 0.313247, 0.301554, 1,        0.932393,
    0.766621, 0.665559, 0.594268, 0.53969,  0.495586, 0.4587,   0.427341,
    0.401685, 0.380179, 0.361636, 0.345298, 0.330672, 0.31741,  0.305541,
    1,        0.943741, 0.775755, 0.673358, 0.60113,  0.54579,  0.5011,
    0.463701, 0.431934, 0.405851, 0.384049, 0.365186, 0.348606, 0.33368,
    0.320219, 0.30796,  1,        0.949253, 0.780225, 0.677225, 0.604536,
    0.548849, 0.503873, 0.466204, 0.43422,  0.407969, 0.385985, 0.366978,
    0.35027,  0.335149, 0.321598, 0.309148};

__forceinline__ __device__ float2 fetch_reflection_lut_idx(int i, int j)
{
  i = clamp(i, 0, REFLECTION_LUT_SIZE - 1);
  j = clamp(j, 0, REFLECTION_LUT_SIZE - 1);
  const int idx = 2 * i + 2 * REFLECTION_LUT_SIZE * j;
  return make_float2(REFLECTION_LUT[idx], REFLECTION_LUT[idx + 1]);
}

__forceinline__ __device__ float2 fetch_reflection_lut(const float2& uv)
{
  const int i = clamp(static_cast<int>(uv.x * REFLECTION_LUT_SIZE), 0,
                      REFLECTION_LUT_SIZE - 1);
  const int j = clamp(static_cast<int>(uv.y * REFLECTION_LUT_SIZE), 0,
                      REFLECTION_LUT_SIZE - 1);

  const float2 t0 = fetch_reflection_lut_idx(i, j);
  const float2 t1 = fetch_reflection_lut_idx(i + 1, j);
  const float2 t2 = fetch_reflection_lut_idx(i, j + 1);
  const float2 t3 = fetch_reflection_lut_idx(i + 1, j + 1);

  // bilinear interpolation
  const float hx = uv.x * REFLECTION_LUT_SIZE - i;
  const float hy = uv.y * REFLECTION_LUT_SIZE - j;
  const float2 tx0 = (1.0f - hx) * t0 + hx * t1;
  const float2 tx1 = (1.0f - hx) * t2 + hx * t3;
  return (1.0f - hy) * tx0 + hy * tx1;
}

__forceinline__ __device__ float compute_directional_albedo_reflection(
    const float3& w, float roughness, float F0)
{
  const float u = fabs(w.y);
  const float v = clamp(roughness, 0.0f, 1.0f);
  const float2 RG = fetch_reflection_lut(make_float2(u, v));
  return F0 * RG.x + (1.0f - F0) * RG.y;
}

__forceinline__ __device__ float fetch_reflection_ior1_lut_idx(int i, int j,
                                                               int k)
{
  i = clamp(i, 0, REFLECTION_IOR1_LUT_SIZE - 1);
  j = clamp(j, 0, REFLECTION_IOR1_LUT_SIZE - 1);
  k = clamp(k, 0, REFLECTION_IOR1_LUT_SIZE - 1);
  const int idx = i + REFLECTION_IOR1_LUT_SIZE * j +
                  REFLECTION_IOR1_LUT_SIZE * REFLECTION_IOR1_LUT_SIZE * k;
  return REFLECTION_IOR1_LUT[idx];
}

__forceinline__ __device__ float fetch_reflection_ior1_lut(const float3& uv)
{
  const int i = clamp(static_cast<int>(uv.x * REFLECTION_IOR1_LUT_SIZE), 0,
                      REFLECTION_IOR1_LUT_SIZE - 1);
  const int j = clamp(static_cast<int>(uv.y * REFLECTION_IOR1_LUT_SIZE), 0,
                      REFLECTION_IOR1_LUT_SIZE - 1);
  const int k = clamp(static_cast<int>(uv.z * REFLECTION_IOR1_LUT_SIZE), 0,
                      REFLECTION_IOR1_LUT_SIZE - 1);

  const float hx = uv.x * REFLECTION_IOR1_LUT_SIZE - i;
  const float hy = uv.y * REFLECTION_IOR1_LUT_SIZE - j;
  const float hz = uv.z * REFLECTION_IOR1_LUT_SIZE - k;

  const float t000 = fetch_reflection_ior1_lut_idx(i, j, k);
  const float t100 = fetch_reflection_ior1_lut_idx(i + 1, j, k);
  const float t010 = fetch_reflection_ior1_lut_idx(i, j + 1, k);
  const float t110 = fetch_reflection_ior1_lut_idx(i + 1, j + 1, k);
  const float t001 = fetch_reflection_ior1_lut_idx(i, j, k + 1);
  const float t101 = fetch_reflection_ior1_lut_idx(i + 1, j, k + 1);
  const float t011 = fetch_reflection_ior1_lut_idx(i, j + 1, k + 1);
  const float t111 = fetch_reflection_ior1_lut_idx(i + 1, j + 1, k + 1);

  const float t00 = t000 * (1.0f - hx) + t100 * hx;
  const float t01 = t001 * (1.0f - hx) + t101 * hx;
  const float t10 = t010 * (1.0f - hx) + t110 * hx;
  const float t11 = t011 * (1.0f - hx) + t111 * hx;

  const float t0 = t00 * (1.0f - hy) + t10 * hy;
  const float t1 = t01 * (1.0f - hy) + t11 * hy;

  return t0 * (1.0f - hz) + t1 * hz;
}

__forceinline__ __device__ float compute_directional_albedo_reflection_ior1(
    const float3& w, float roughness, float eta)
{
  const float u = fabs(w.y);
  const float v = clamp(roughness, 0.0f, 1.0f);
  const float z = clamp(eta, 0.0f, 1.0f);
  return fetch_reflection_ior1_lut(make_float3(u, v, z));
}

__forceinline__ __device__ float fetch_sheen_lut_idx(int i, int j)
{
  i = clamp(i, 0, SHEEN_LUT_SIZE - 1);
  j = clamp(j, 0, SHEEN_LUT_SIZE - 1);
  const int idx = i + SHEEN_LUT_SIZE * j;
  return SHEEN_LUT[idx];
}

__forceinline__ __device__ float fetch_sheen_lut(const float2& uv)
{
  const int i =
      clamp(static_cast<int>(uv.x * SHEEN_LUT_SIZE), 0, SHEEN_LUT_SIZE - 1);
  const int j =
      clamp(static_cast<int>(uv.y * SHEEN_LUT_SIZE), 0, SHEEN_LUT_SIZE - 1);

  const float t0 = fetch_sheen_lut_idx(i, j);
  const float t1 = fetch_sheen_lut_idx(i + 1, j);
  const float t2 = fetch_sheen_lut_idx(i, j + 1);
  const float t3 = fetch_sheen_lut_idx(i + 1, j + 1);

  // bilinear interpolation
  const float hx = uv.x * SHEEN_LUT_SIZE - i;
  const float hy = uv.y * SHEEN_LUT_SIZE - j;
  const float tx0 = (1.0f - hx) * t0 + hx * t1;
  const float tx1 = (1.0f - hx) * t2 + hx * t3;
  return (1.0f - hy) * tx0 + hy * tx1;
}

__forceinline__ __device__ float compute_directional_albedo_sheen(
    const float3& w, float roughness)
{
  const float u = fabs(w.y);
  const float v = clamp(roughness, 0.0f, 1.0f);
  return fetch_sheen_lut(make_float2(u, v));
}